---
layout: blog
banana: true
category: php&&MVC
title:  "mvc 自己封装一个框架"
date:   2018-01-13 20:06:42
background-image: data:image/jpeg;base64,/9j/4AAQSkZJRgABAQAAAQABAAD/2wBDAAgGBgcGBQgHBwcJCQgKDBQNDAsLDBkSEw8UHRofHh0aHBwgJC4nICIsIxwcKDcpLDAxNDQ0Hyc5PTgyPC4zNDL/2wBDAQkJCQwLDBgNDRgyIRwhMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjL/wAARCAIFAfQDASIAAhEBAxEB/8QAHwAAAQUBAQEBAQEAAAAAAAAAAAECAwQFBgcICQoL/8QAtRAAAgEDAwIEAwUFBAQAAAF9AQIDAAQRBRIhMUEGE1FhByJxFDKBkaEII0KxwRVS0fAkM2JyggkKFhcYGRolJicoKSo0NTY3ODk6Q0RFRkdISUpTVFVWV1hZWmNkZWZnaGlqc3R1dnd4eXqDhIWGh4iJipKTlJWWl5iZmqKjpKWmp6ipqrKztLW2t7i5usLDxMXGx8jJytLT1NXW19jZ2uHi4+Tl5ufo6erx8vP09fb3+Pn6/8QAHwEAAwEBAQEBAQEBAQAAAAAAAAECAwQFBgcICQoL/8QAtREAAgECBAQDBAcFBAQAAQJ3AAECAxEEBSExBhJBUQdhcRMiMoEIFEKRobHBCSMzUvAVYnLRChYkNOEl8RcYGRomJygpKjU2Nzg5OkNERUZHSElKU1RVVldYWVpjZGVmZ2hpanN0dXZ3eHl6goOEhYaHiImKkpOUlZaXmJmaoqOkpaanqKmqsrO0tba3uLm6wsPExcbHyMnK0tPU1dbX2Nna4uPk5ebn6Onq8vP09fb3+Pn6/9oADAMBAAIRAxEAPwD3+iiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKoXWqRwyGGFDPOOqJ0X6ntVF0ubvm7nZUP8AyxhYqv4nqa0jTb1Jc0tjQuNVs7aQxtLvlHWOMFmH1A6fjVZtTvJf+PeyCDs074/QZpsUMUCBIY0jQdlGBT81ooRRDk2RFtSl+/eRxD0ii/qf8KYbWZ/9ZqF4x9nC/wAgKsZozVfIRW+wL3ur0/8Aby/+NL9iI+7eXq/9t2P881YzRmmKyIRFep/q9SmPtIqt/ICnrdapF1FvOPxQ/wBRT80ZpWT3Qxy60icXVvNAf723ev5ir8M8NzGJIJUkQ9GQ5FZ2arvZwtIZY90Mx/5aRHaT9ex/HNQ6aew1Jo3aKx49Qu7Xi5T7RF/z0jGGH1Xv+FacFxFdRCWGRXQ9xWUoOO5akmS0UUVJQUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFNkkSKNpHYKqjJJ7CgAd1jRndgqqMkk8Csee8mvyVhLwW398cO/09B+tRyzPqMgkkBW2BzHGf4v9pv6Cpc10Qp21ZlKV9hIoo4IwkSBVHYU/NNzRmtCR2aM03NGaLBcdmjNNzRmiwXHZozTc0ZosFx2aM03NGaLBcdmjNNzRmiwXHZqBoWjlM9s/lTHrj7r/AO8O/wBetS5ozRYC5ZagtyxilXyrhRkoehHqD3FXawpYhKByVdTlXXqp9qu6ffGZjb3GBcKM5HRx6j/CsJ07ao0jLozQooorIsKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKwry4+33RiU/6LC2G9HcdvoP51c1e7a3t1ihOJ5jsQ+nqfwFUIo0hhSJBhVGBW9GH2mZTl0Jc0ZpuaM1vYgdmjNNzRmiwDs0ZpuaM0WAdmjNNzRmiwDs0ZpuaM0WAdmjNNzRmiwDs0ZpuaM0WAdmjNNzRmiwDs1FNGZFDI2yVDuR/Q/wCFPzRmiwGlp96L233EbZUO2RP7rf55q3XOCY2N8l0OI3xHMPbsfwJ/WujByMiuWpDlZrCV0FFFFZlhRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUVFdTCC1llboilj+FAGDNL9r1aeXOUg/cp9erH+Q/A1JmqengrYxF/vuPMf/ebk/qas5r0FGysct76j80ZpmaM07BcfmjNMzRmiwXH5ozTM0ZosFx+aM0zNGaLBcfmjNMzRmiwXH5ozTM0ZosFx+aM0zNGaLBcfmjNMzRmiwXH5ozTM0ZosFwlRZomjflWGDWholy1xp4WQ5lhYxP7kcZ/EYP41n5p2kSeVrNzD/DNGsoH+0PlP6bayrRvD0Kg7SOgooorjOgKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACsvxE5TRLkD+Jdv58f1rUrH8TcaO59GU/wDjwqofEiZfCykvCge1LmmA8Uua9GxzDs0ZpuaM0WAdmjNNzRmiwDs1l+Irq/s/D19daYsbXkMRkjWRSynHJGAR2rSzSHBBBGQeoqZJtWQ00nqZVh4gt7vwnDrzELC1r9ob2wMkfgcisfSte1a60fQLy+ubC1m1GYkwtE+XjIJVV54bbgkniuPkkms5b74eLn/SNQDW+O1pJ+8b8B8w/Gus8WRpBq/hCKNQqJqAVQOgAjapUuZ83p/wf8irW09f+AbWs+LdB8PypFquqQWssg3KjkkkeuBmrP8Abul7LJxexMl8222ZTkSnGcAj6GvMxDcnxz4mW48WRaHcNOrKk1tC3mw7QEIaTsOmBVybQoLP4bPLpepjUzY3rX0VwkYQblf51ULwBw3TilGba5nsDir2R6KdVsRqw0s3KfbjF5wg/i2ZxmlttTs7u7urS3nWSe0ZVnQZ+QkZAP4V5ZJqMbamfiDu/wBGS/W0D9f9GCbCR7byTXZeALdh4efU5QftGq3El7ISOzN8o/75C1UW2/68rfgKSS/r7zrM0ZpuaM1diR2aM03NGaLAOzRmm5ozRYB2ajhby9csmH8QdD+Wf6U7NQg51jTwP77H/wAdNTNe6xrdHWUUdqK846gooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKy/EERl0W5VfvBCR9RzWpUVwnmQOh7imnZ3E1dWOYhkEkEcg6MoIp+ap2GY4Gtm+9buYvwH3f0xVrNepvqcg7NGabmjNFgHZozTc0ZosA7NGabmjNFgIG06xbUF1BrO3N6qbFuDGPMC+gbrj2p81rbXMkMk9vFK8Lb4mdASjdMjPQ1JmjNFguU9Q0XStWKHUtMs7wp9w3ECybfpkcVYjtbeK0FpHBElsE2CJUAQL0xjpj2qTNGaXKguVBo+mDTP7NGnWgsOf9GEK+Xycn5cY681bijjhiSKJFSNAFVFGAoHQAUZozTsFx2aM03NGaLAOzRmm5ozRYB2aM03NGaLAOzTLUeb4gtlH/LONnP4kAf1pc1N4ej8/ULu7P3QREn0Xr+pNZVnaDKgryR0tFFFeedQUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFHWiigDkdUh+w615nSK5GD/vDpS5rb1rTxf2Lp0ccqw6g+tc1aztJGVkGJoztkX3/wAK78PPmjyvdHNVjZ3LWaM0zNGa6LGQ/NGaZmjNFgH5ozTM0ZosA/NGaZmjNFgH5ozTM0ZosA/NGaZmjNFgH5ozTM0ZosA/NGaZmjNFgH5ozTM0ZosBHdzmG3Zl5c/Kg9SeldFolkLLTY4/4sZJ9TWBplsdT1MSnm3gOF9Gbufw6V2AAUADtXDiZ3fKuh0Uo6XFooormNgooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiub8SR3kcsV3BNc+WnEkMUzIGHrx3pN2KhFSdm7HSUVyltHb30K3EV9fsh7fbJRg+hAbrT20+EsCZbxiOm68lP82qOc6Pq3n+B1FFcm+n25ILec2Om6dz/Wq9xp9qYmPlkkKcZdjjj60e08i1hE/tfh/wTtDyK5fXdNeCf7fbLkjh1H8QrX0GVptCsnY5JhTn8BV90WRSrDINawm4tSRxTgtYs4uKZJoxIhypp+ak1XSZbCdrq0UtGxy8Y7+496qQ3CTpuRs9iO4PvXq0qkaiujinFxdmT5ozTM0ZrSxFx+aM0zNGaLBcfmjNMzRmiwXH5ozTM0ZosFx+aM0zNGaLBcfmjNMzRmiwXH5ozTM0ZosFx+agfzLyf7Hb53H/AFjj+Ef40zzJbub7NZ/M+cM/UL/9euq0jSYtOgAAzIeWY9Sa5q9ZQ92O5tTp82r2LGn2UdjapEigACrdFFecdQUUUyaaK3jMk0ixoOrMcCgB9FYtx4jiVGa0t5blV5ZwNq474J61rwzJPCksZyjgEGqlCUVdolST2H0UUVJQUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUyVUaNhJjbjnNPJwMmubvrxtXlaCFiLBDiRx/wAtj6D/AGfX1pN2NKdNzdkULSBTq893ZsyWbDbjtMf730Hr3rRZqOFUKoAA4AFRs1YNnoxjsgZqgkOVI9RTmaomapZvGJs+GDnw3YH/AKYJ/IVr1jeFf+Rcsh6RgVs10x2R41X436jXRXUqwyDXNar4eIkNzYny5e47H6iunoqoycXdGbSaszz0XZik8q7TyZOnP3T9DVnNdVfaTbXyESRgk98VzF14evbEk2Um6L/nm/I/D0rvp4tPSZzToNfCMzRmqTXjwHbdW8kRHcDIqaK5hmH7uRW9gea64yjJXizBprcnzRmmZozVWFcfmjNMzRmiwXH5ozTM0FgBknA96LBcfmjNU31C3U7VYyN6RjdUkMGpX5xBD5KH+Jxk/l0rOdSEPiZUYylsiSa4igXdI4X0Hc0trZ3urPhVaC3PU/xMP6Vr6d4WiiYTXJMsp6sxya6KOJIlCooAHpXFVxbekNDphRtrIp6dpdvp8ISNACO9X6KK4zcKhurmOztpLiUkRxjc2Bk4qaq97ALm0kiIyGUgiheYGHLrt7dDFpCtvGekkvzN+Cj+tVRbLLIJbmSS5lH8cxzj6DoPwFVNPZkje2kP7y3cxnPcdj+WK0VNekoRivdOTmb3LC4xjHHpU3h+Xy1n09jzbtmPPeNuV/LkfhVZTUbyfY9RtbwcLnyZf909PyP86zqR5otFxdnc6eigHIzRXCdAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRWBqV+99M9jaOViU7Z5lP/jqn19T2pN2Lp03N2QzUL5tTle0tnK2iHbNKp++e6qfT1NIAsaKiKFVRgAdAKERIYljjUKijAA7CmM1Yt3PRhBRVkDNUTNQzVTvLxLWPcQWdjhEHVj6VLZvGI2+vVtIxwXkbhEHVjUNtfJdIeCki8PG3VTWroWhu7m+vwGmfovZB6Cl1zw8Xb7XZfu519OhHofaq9m7XMFjIKpy9O5e8Jn/AIp62HoCP1NbdYvhaCa20SKK4TZIC2VznHzGtqto7I8+q06krd2FFFFMzCoop4bkMYpEkCsVbac4I6isXWtTd5G0+0chv+W0q/wD0Huf0rMgiksJFnsCEcABkP3ZB6H3966IYdyjzGUqqTsdTPY29wMSRqfwrHu/CVjcEkIAa1NO1KHUYiUykqcSRN95T/nvV2sdYvzNNJI4yTwlcxH/AEe7lUem7I/XNV20LWYzhbgOP9pB/TFd3RWir1FtIh0oPocCdJ1sd4T/ANsj/wDFUo0fW2/jiH0j/wDr13uBRin9aq9xexh2OITw1qcv+svHHsoUf0zVuHwbESGuJHkP+2xb+ddZRUSrVJbspU4LoZdroNlagbYhkVopGkYwqgCn1Q1a6a3tCsX+ulOxPqe9Qk27FSkoq7GrrdoZnjYsiqxUSMPkYjrz9a0AwYAqQQehFYUcCRQLCACqjHPeokjltG3Wcxi7mM8ofw7fhit3RT2OOOJa+JHR0Vkw62qkJexGBv745Q/j2/GtRHWRAyMGU9CDkGsZRcdzqhUjNXix1FFFSWchrMH2HW47gDEdwPLf69Qf5j8akU1q+ILH7bpsir/rFG5T6EdKwbKf7RbRydCRyPQ9xXfh5c0LdjmqK0r9y+pp00S3FvJC3RxjPpUamplNWyUaGi3bXWmoZP8AWxkxyD/aHBrRrnrCX7HrTJ0ivFz9JFH9Vx/3zXQ1w1I8sjog7oKKKKzLCiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiisXVNSkaVrCxfE2P3so58of/FUm7Fwg5uyG6nqMlxM1hZOVI4nnX+Af3R/tfyqvFFHbwrFEoVFGABSQwx20KxRLhR+JJ9Se5oZqxbuejCCirIGaomahmqrdXUdrCZJDgDoB1J9BUtm8Yjbu7S1iLvknoqjqx9BVrQ9GkuJhqF+P3h+4nZB6D/Go9F0eW+uBqF8uP8AnnF2Qf4116qEUKowBWkIW1Zw4nEc3uQ2BVCgADAFKRnrRRWpxCBQowBiloooAKx9Z1VrbFpakG6kHXqI1/vH+lTavqg0+EJGA9zJxGn9T7CufghKlnkcyTSHdJIerH/D2rpoUeb3pbGNSdtELBAsKbVyTnJYnJY9yT61ZVaRVqVVrrbMUiJ7djIs8EhiuU+647+xHcVsabqq3ZMEy+TdoPmjJ4I9VPcVmzTR20DTSttRRkmmaHb3F5enUrhdi42wof4V/wATXNW5XG7NYXT0OmooorkNwooooAKKKKACsN3N7qckv/LK3zGnu38R/Dp+dX9TumtrQ+X/AK1zsjHuaqwQLb26RLztHJ9T3Na011OavK/uiMKjYVKwqMiuhHJJELAEYIyKoyXKaa5eC7+zueTGPmVvqv8Ahirl1G0tvJGrFWZSAQcYNM0XQ7OW0juWXczDnPr3onNRWquTSpOc9HY09H1OXUYGaWDyyDgEHhvcDqK06jhgjgXbGoA9qkrjbuz1IppWbuI6hlKnoa4p4jYazcWp4jl/fR/Xow/kfxNdtXOeKbYrDHfRj54G3H3Xv+la0J8s/UmrG8SBTUymqsTh1VlOQRkVYU13SRzobeozW3mR/wCthIkT6iuitLhbq0inQ5V1DCsVTUmhS+RNc6ex4RvMi/3G7fgcj8q5a0bxv2NabszcooorlNwooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigDI1XU5I5fsNmR9qZcs5GREvr9fQVRggjtovLjye7MxyWPck9zT9e0u4eYX9m+24QY9mHofaqVnqCXiEFTHMnEkbdVP9RWU731O/D8rjaO/UtM1RM1KzVWnnjgiaSRgqKMkms2zsjES5uY7eFpZW2qKNH0mXVLlb68UrGv+qiP8I9T71HpWmTazdLd3SFLdDmKI/wAz712kcaxIEQYArSEOrOPE4j7EPmKiLGoVRgCnUUVqcAUUUUAFU9S1GLTrYyONzk7Y4x1ZvSpby8hsbZ552wi/mT6D3rlS819dG8uRhzxHH2jX0+vqa2o0ud3exnUny6LcRFllme6uW33En3j2UdlHsKsqtIq1Kq13N20RzpCqtPJWNC7sFVRkk9hSgYGTWYqvr135MWRYxt8zf89SP6fzrOUkldlpX0Q+ztpNevFnkBWyjP7tD/Gf7x/pXWxxrFGEUYAptvbpbQrGgAAFS1wzm5O7N4x5UFFFFSUFFFFABRRRQBzOq6jImsYFrJKIV/dgcKWPU59h/OqlxJrk0RnG2FF+bYg5PsSa60wRF95QFvWiWNXiZMcEVp7RrYxdFNtt7mVDKs9vHKvKuoYUMKqabmL7RZt1gkO3/dPI/XIq4wrdM4mu5Ewp2iyeTd3Nofuk+cn0PUfn/OkYVWd/s15bXPZW2N/ut/8AXxTmuaLQqcuSaZ0tFIDkZpa4z1AqG6hW4tnjYZDDFTUUAcNY7oGmsn+9bvtGe6nlT/T8K0FNR69B9j1aC8UYSX91J/Q/n/OnKa9OEueCZyNcsrFhTUc8htbq2vh0jbZJ/uN1/XBpymnvGs0LxPyrAg1Ml3GjoQQwBHQ0tYGn63BBYLBcuzXUJMbRopLNjoce4waZca1ftdWsUUEcCTSY/eHc5Uck4HA/+vXF7KVzf2iOiopAcgGlrMsKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigBCARg1zmt6EXf7ZZN5dwnII6H2I7iukoIyMGk1fcqMnF3RwkOpI8bi4AgmiH7xGPT3HqKdpuny67dLcTqVs0OY0P8X+0f6Vv6h4bs9QuEmkjG5TmtWCBLeIRoAABUKnZ3Z1VMW5Q5Yqz6iwwpDGEQYAqSiitDjCo55lt7eSZgSEUsQO+KkqtqCb7GZfVCKEAmn6jbanarcW0gZD1HdT6EVNNNHbwvNK4SNBlmPYVwelPPb21td2jBZvKXcp+7IMdD/jWjd30+sOgliaC2jwfKY8u3qfYdq65YVqdlsYRr3jruJPcyardC5lBWBD+4iP/oR9z+lSqtCrUqrXTpFWRlu7sFWpVWhVqhe3Ms040+yJ85v9ZIP+WY/xqJMpIZcPLqt0dPtSREDieQf+gj+tdTY2UVjbrFGoAAxxUOlaXFptqsaKAccmtCuKpPmfkdEY8oUUUVmUFFFFABRRRQAUUUUAFFFFAHP6gn2TWoZxwkw8tv5irTU/XLY3GnuU++nzL9RVe2mFzaxTD+NQa6KbujirRtP1FIqvcRCaF4zxuGM+lWSKjYVsmcskX9JuTdadE7ffA2uPQjg1erC0iTyNRuLYn5ZR5yfXo39D+NbtclSPLJo9KjPngmFFFQ3V1FZ2zzzEhEGTgZP5VBqVNbshfabLF/Fjg+hrm7CczWqM3Dj5XHow4NXJvE8t6hGnxIkZ482bk/go/qao2sAg8w72d5H3uzY5P0HAr0KFOcE+Y5ak4yehfU1MpqupqZTVyQkToqhiwUBj1OOTVbS0/tDW57s8xQfuYvw+8fz4/CmX90baxd0/1h+RB/tHgVsaLZCx02KPvjJPqa5qztG3c1grs0aKKK5TYKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAqK4Gbdx7VLTJRmJh7UAcNpa/8S+If3cr+RIrQVaq6cuIZF/uzyj/AMfar6rXrORxJAq1Kq0irUGoXosYAVTfLIdka+re9ZNljL+9eEra2oDXcv3R1CD+8a1tF0hNPg3Nlpn+Z3bqT6moND0cwA3d0fMuZfmdj/npW9XHVqc2i2N4RtqwooorIsKKKKACiiigAooooAKKKKACiiigBsih0ZT3Fc7YA29xdWR/gfen+63/ANfP510lYGqp9l1W3uhwr/u3+h6frWlN2djGvG8b9idhUZqZqjIrpRwyRTnc288F0P8Alk/zf7p4NdKpDKCOhrn5oxLE8bdGBBrR0W4NxpyBz+8jzG/1HFZV1ombYSVm4mhTJYlmjKN0NPornO45W/8ACaNIZrSRopPVDj/9dZTjU9ObbcwefGP40GG/Loa7+mPEkgw6gitYV5w2ZnKnGRxlrqFtcnakmH7o3DflV9TVvUPDNneAnYFbsRWNJpmr6Y37iT7REP4JeT+DdfzzXRHERlvoZunJbak8aHUNdigHMVsN7/756D8Bz+IrrQNqgDtWL4csJLa1ea4AFxMxd/qe39K265qsuaWhrBWQUUUVmWFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFZs+sRhzFaRm5lHB2nCL9W/wzSbsVGLk7I0qqXGp2dq22W4QP/cHLfkKzHjurv8A4/Lo7f8AnjBlF/E9T+YHtUkNvBbjEMSIP9kVPN2NlRS+Jkp1ov8A8e9jcSe7AIP1phv9Uf7traxj1eUsfyA/rT80ZpXZahBdCL7RrB/5a2K+3lOf/ZhR9p1gf8tLFv8Atm4/9mNS5ozRqOy7DBqGqJ9+ztpB6xzEH8iP609dbCf8fFlcxe4UOPzFGaM0XYnCD6Fu21G0uziGdGb+7nDfkeastyh+lYs1rb3A/ewo/uRzTFW8tB/olyXT/njcZYfg3UfjmnzdyHRX2WZdiuJb1f7t0/64P9avqtZL2LXOoS5ubiykmfcY/MwrHAHykdegq2PCUrffvJ278ysf613LEQaRwyozi7NF8AAZNRzraTxGK4eMqfVgMf4VXXwZAfvuzfUk1Mvg6yHUZpOtEPZsksdbjtZ47G6uopVY7YZg4JP+y2O/v3roaxrXw3ZWkgeNBke1bAGBisJtN3SNIppai0UUVBQUUUUAFFFFABRRRQAUUUUAFFFFABWfrNr9q0+RR94DKn0NaFIyhlIPehaCaurMw7Of7TZRS9yvzD0I4P61IwqpZg21/d2Z+7u81Poev6/zq6wrrTvqedJW0ZCwpNMk+z6rLCeEuF8xf94cH9MU81m3V5DFc27JIrTpICEU5JB4P6VUlzRaIjLkmpHW0UincoPrVObUUVzHApnkHUL0H1NcaTex6cpKOrLtQT3lvb8SzIp/u55/KqLJc3P/AB8TlF/55wfKPxbqfwxT4raCD/VxKp9cc1ah3MnVfRDzqgb/AFFtPJ77do/M0w3V8/3bSFR/00lP9BUtFVyrsRzyfUhEmpdmtF/4Ax/qKPM1Mf8ALW1Pt5bD/wBmqaiiy7Cu+5ELnUV6xW0n0dl/oacNRmT/AF1lKB6oQ3/16fRRZdh80l1HR6naSNtMuxv7sg2n9atggjIqg6JIuHUMPQjNQC08k7rWV4D/AHRyh+qn+mKlwXQtVWtzWorOTUJYeLyIbf8AnrFkr+I6ir8ciSoHjYMp6EHNQ4tbmsZqWw6iiikUFFFFABRRRQAUUUUAFFFFABRRRQAVFc3MVpCZZnCqPzPsKbd3cdnAZZCfRVHVj6CsfElxN9pusGT+BB0jH9T71MpWNadPm1ews0txqP8AriYbbtCpwz/7x/oPxqVFSNAiKFUdABiiioudSVlZDs0ZptFILDs0ZptFAWHZozTaKAsOzRmm0UBYdmjNNooCwkkccyFJFDKeoIpkNxcadwC1xa/3W5eP6HuPY81JRTuDSaszVgniuYVlhcOjdCKkrAUyWcxuLYZz/rIugf3Hoa2ba5iu4FmibKt+YPoferjK5y1Kbhr0JqKKKoyCiiigAooooAKKKKACiiigAooooAKKKKACiiigDA1tfsl5b3wB2qdsmBn5TVB9YmuG22Nm7/7cnA/LrXVSwpOm2RQRSRW0UIwiAfhWkajSsYyoqUrtnMJo+p3/ADd3LIh/gj+UVoQaLYaYnnSYyO56k1rXNwlrFvbknhVHUn0FZ4V5ZfPuMF/4VHRB7e/vQuae7E+SnpFag7TXgw5MNv2jH3m/3j2+gqVEWNQqKFUdAKXNGa0sY3u7sWikzRmgLi0UmaM0BcWikzRmgLi0UmaM0BcWikzRmgLi1B5LwuZbV/Lc9V/gf6j+oqbNGaAJrW9WcmN18uYdUP8AMeoq1WXLEsoGchl5Vh1U+1T2l2zP5FxgTAcEdHHqP8KzlC2qN6dS+ki7RRRWZsFFFFABRRRQAUUUUAFMlkSGJpJGCooySewp9YerT/artLFT+6TDze/ov9fwpN2RdOHPKxCsr30/2uYEL/yxjP8ACvqfc1PmmZozWR32toh+aM0zNGaAsPzRmmZozQFh+aM0zNGaAsPzRmmZozQFh+aM0zNGaAsPzRmmZozQFh+aM0zNGaAsPzUKznTrj7Sv+oc/v19P9of1p+aDggg8g0A4pqzN1WDqGU5BGQRS1i6NcGGWTT3Pyr88BP8Ac/u/gf0xW1Wqd0cE4OErBRRRTICiiigAooooAKKKKACiiigAooooAKKKKACmSypDE0khwqjJNPrJvJftV6IB/qocNJ7t2H9fyqox5nYipPkjcahe4l+0zDBP+rT+4v8AiamzSZozW9jjv3FzRmkzRmgLi5ozSZozQFxc0ZpM0ZoC4uaM0maM0BcXNGaTNGaAuLmjNJmjNAXFzRmkzRmgLi5qOaMSrjJVgcqw6qfWn5ozQBYsbs3CMkgAmjOHH9R7GrdYs7NBIl3GPmj4cD+JO4/rWxG6yRq6nKsMg1jONnodVKfMrPcdRRRUGoUUUUAFFFFAEVzOltbSTyHCRqWY+gFc3ZhzEZ5hiadjI49M9B+AwPwrQ8RyZs4rUf8ALxKqH/d6n9Bj8arZrKb1sduGhaLl3HUU3NGag6LDqKbmjNAWHUU3NGaAsOopuaM0BYdRTc0ZoCw6im5ozQFh1FNzRmgLDqKbmjNAWHUU3NGaAsQXbm38q8T71u24+6/xfp/KunjcSRq6nIYZFc6wV0KsMqwwRV/w9M0mkpE5y8DNCx9dpwD+IAP41pB62OfEx91SNWiiitDiCiiigAooooAKKKKACiisWXV5oNanhZQ1pFFGWwPmUsWyfccCk3YqMHLY2qKajrIiujBlYZBHenUyQooooAgvLgWtrJMedo4Hqay7WMxwDecyMS7n1Y8mptYfe9tbf333N9BzTc1vTWlzjryvK3YdRTc0ZrQxuOopuaM0BcdRTc0ZoC46im5ozQFx1FNzRmgLjqKbmjNAXHUU3NGaAuOopuaM0BcdRTc0ZoC4pwRg0/SJNnm2bHmI5T3Q9P6j8KjzUIfyNUtpe0mYm/mP5H86mavEunLlmmbtFFFcx3hRRRQAUUUUAc7rT79ZtI+yI7/jwKZmm6of+KiXPa3OP++qM1hL4mepRX7uI7NGabmjNSaWHZrmNT8b2tlqkmmWWnahq15CMzx2MQbys9NxJAz7V0ua4n4aFP7L1Uv/AMfx1O4+05+9u3cZ/CmtyZXVkup02ia5b67Ym5t45omRzHLDOhR43HVSP8OK0s1xvjq8nW2sNNsrtrQ6jepbz3EJAdFIyRnsSOKydT0S38E6pot5olxdxm5vEtZ7eS4eVZkbvhieR14prX8v6+8lycfO2p6Rmq2oX8GmafPfXTlYIEMkjAZIA68CvPbfQYvEfj7xPDqF5eGyheHFrFO0aljGOSVIPHpVE2f234YeI9Pv7ie5TSLq5htpHkIbbH93cQeevek/hv5XHzO9reR6pa3UV7ZwXUDFopo1kQkYypGR+hqXNeYXmj2mgfB27udOM8U1zYwSyM07v82F6ZJx1PAq1rNgfCHg65vtPvbptTvfKimvZ5mcgsQC+0nC4yemKqSs2l3sTGb5U2ulz0XNYUeuXD+N7nRCkX2aKxS5D4O8sWIxnOMcelcd4h8NW3g7RYtd0m9vl1G3kj3vLcu4ussAyspOOevAFbdq274qXjEYJ0iI/wDj7UraX9fyHzPZ+X4s1vB+t3HiHwzbandJEk0rSBliBCja7KMZJPQVu5rx2DUtQs/hVolrpyu0t9fSQNsmERKmV8qHIO3PTNanhnQvEOl+JbWaHRJNL09gy3avq/2tZBjg7TyCD6VTXvMXPbS1/wDhz07NGa848KaDDq+ta3qN/dXcptNZnW2hE7KkZDZzgHnOeh44r0XNR0Rcbu47NGabmjNIqw7NTeH3232ow9vMWQfioH/stV80/RD/AMTy9A6eVF+fzVUPiMq6/dP+uptz6hZ2snlz3Mcb4ztZucVF/bOm/wDP7D/31WLPh/EV9vUHEUQGR7vUuyP+4v5Vbm7mEcPFxTZq/wBs6b/z+w/99Uf2zpv/AD+w/wDfVZWyP+4v5UbI/wC4v5Uudj+rR8zV/tnTf+f2H/vqj+2dN/5/Yf8AvqsrZH/cX8qNkf8AcX8qOdh9Wj5mr/bOm/8AP7D/AN9Uf2zpv/P7D/31WVsj/uL+VGyP+4v5Uc7D6tHzNX+2dN/5/Yf++qxYbiK412/khcPGYohuHTOXqXZH/cX8qVQq/dAH0FJybLhRjDVEkFw2myEqC1oxy6D/AJZn1Ht6itxHWRFdGDKwyCO9YO6ktrptNkJGWtGOWQf8sz6j29RTjKxFWjzarc6Gimo6yIrowZWGQR3p1anEYd43ma4B2jhz+JP/ANapKrynOuXPtEmPzapq64L3UebUfvsdRTaKom46im0UBcdXL654603w/wCJLHRbyC5Ml2iuJ0AMcYLFRuOcjn27101eaeLdHTX/AIhvpzfel0F/LburiUlT+eKiTaat/WjZcEne/wDWp6JqF/b6Zp1xfXL7YIIzI59gKyvCfiq18XaXLf2ltcW6RTtAyXAAbcAD2J9a4tNdfxjo+geHycXVxIRqaDrGkBw4P+8wH4GqtlqVzovgTxbPYP5Mw1uaKOQD/Vbii7vwzRzWbfS36r/MfJol1v8A5/5HrlFeWa/4VtvCfhtfEOmajqC6rbGORp5Lp3FySRuVlJ2/NnsBVu+tF8ZfEB9K1Se5TT7LTorhbSGZovMlcnLEqQTgcdad3e3X/gXFyq176f1/mdNo+v3WoeLvEOkyxwrBpvkeSyA7m3qSd3OO3GAK6KvJtG8zwtqvxCa0nnuns4Ldomnfe4/dsQCe+Pf0rHsdC8V3lnaatY6FcrqcuyYam2vbt+eSTERtwR24pKWy9PxKlBXev9WR6l/blz/wn50Dy4vsv9mC834O/f5hTGc4xj2rfriYt/8AwuBfMwJP+EfXdj1885rtKpbL5/myJ6P7vyQ6im0UybjqKbRQFx1Vb87YFkHWORW/WrFVdR/5B830/rRYTZ0SHKA+1OqOD/Up9KkriPVCiiigAooooA5jWhs1+2c9HiZfywabmp/FCeWLW77RSjcfY8f1FVc1hPSR6mGd6SH5ozTM0ZqTew/NcvqXgixvdUl1K01DUtKu5v8AXyWE4j8303AgjPvXS5ozRcTimrM57/hCNGbQZNJlWeZJJPOe4klJmaX/AJ6buzfTj2qPTfBNpZalDqF3qWp6pcQZ8hr+cOIs9SoAAz9a6XNGafMxezj2M6x0S20/WNS1OKSVptQKGVWI2rtXaNvGfzzUVp4asLWx1SzJlmg1KeWadZCOsn3gMAYHp3rWzRmlfoPlRzEHge1j8NXegy6rqlzZ3CLGDPMrNCq9FT5cAcDsa3b/AEuz1PS5NNvYhNayJsZWPUfUdDVrNGaG29wUEtjlLT4f2MNzbSXeq6tqMNqwa3try4DxRkdCAAM4981tpotsniGXWhJL9olt1timRsCgk56Zzz61oZozQ22JQitkc+ngvSR4WTw9L501ojM6OzgSKxYtuBAGCCeKNI8Jppd+t3NrWsai8akRre3IZUz1IAA/XNdBmjNPmYckX0KGkaNb6N9u+zySv9su5LuTzCDh36gYA44rSzTM0ZpXKSsPzRmmZozQFh+al8PjfqmoSDoCkf5Ln/2aq5YAZJ4FXfC0ZOnvckc3EjSD6E8fpiqh8Rz4p2p+pTnOPEV//wBc4v8A2epN1V7w48R33/XOL/2el3UpPVmtKN4L0J91G6oN1G6lcvlJ91G6oN1G6i4cpPuo3VBuo3UXDlJ91G6oN1G6i4cpPuo3VBuqq8s15cfY7PO7pJIP4Pb60LUmVoq7NTRrxk1F7SE77fBLjtG3oPr3FdJWdpWlxadbhVHzdzWjXRFWVjyqs1OTkkc/cjZrz5/jhGPwP/16lpmsr5OoWtx2JKH8aWuynrFHk1laox1FNoqzO46im0UBcdWW+hWz+J49eMkv2pLU2oTI2bS27OMZzn3rSopWC5haT4Q0vRvEOp63aiX7VqBBkDEbU7naMcZPJzmltfCOl2+manp0gkubXUriS4nSYj7z4yBgDA447+9blFHKrWHzu97nH2vw40+Ke3N1q2saha2zB4LO7ud0MZH3cAAE49yav694Os9c1GDUkvr/AE2/hj8oXNhMI3aPrtOQQRk56V0NFHKh88r3Of0TwXpWgyai1uZ5RqCItwtxJv3bQRnJGSTuOcn8qz7f4dWdpIkcGt64mno+5dPW7xABnO3GN2M+9dhRRyoXPLuZo0O2Hib+3hJL9p+xiz2ZGzZv3Z6Zzn3rUptFOwm7jqKbRQFx1FNooC46qmonNpt7u6qPxNWarTDzr+ztx/fMjfQf/XIpPRXHFXaR0cIxEo9qfSAYAFLXEeqFFFFABRRRQBR1ezW+02aBujKRXLWUzTWymT/WplJB/tDg/wCNdsRkYrjtStzpurlwMQXJ59n7fnWdRaXOzB1LS5H1H5ozTc0ZrA9Ow7NGabmjNAWHZozTc0ZoCw7NGabmjNAWHZozTc0ZoCw7NGabmjNAWHZozTc0ZoCw7NGabmjNAWHZozTc0ZoCxBfMxgECf6yc+WuPfqfyrr7C3FtZRRKMBVArmdFtzqGqNdEfuIMpH7nuf6V1/St6asrnl4ypzT5V0Od1bw0uo3puVkZHYAEqxGQOn86of8IY3/P1L/32a7Gir5V2MFVqJWUmcd/whjf8/Uv/AH2aP+EMb/n6l/77NdjRS5Y9h+2qfzP7zjv+EMb/AJ+pf++zR/whjf8AP1L/AN9muxoo5Y9g9tU/mf3nHf8ACGN/z9S/99mj/hDG/wCfqX/vs12NFHLHsHtqn8z+847/AIQxv+fqX/vs1QitG03U7q1aVnUJGw3HOMlv8K9AritXs7y48STJAhVJYowZfTBbOPfkVE46aI6MNXam3UlpYr7pr24+yWmd3R5B/B7D3rrNK0qHTrdVVfm7mjStKh063VEUbu5rRqoR5UY167qvyCiiirMDO1q1Nzp7hfvryp9xWZaz/aLZJOhI5Hoe9dGyhlIPeuXkjOn6m8J/1Mx3IfRu4/Gt6MteU5MVDTnRbzRmm0V0nDcdmjNNooC47NGabRQFx2aM02igLjs0ZptFAXHZozTaKAuOzRmm0UBcdmjNNooC47NGabRQFxc0mjIbrUJ7s/cX92n0HX9c1WvZWVFhi/10p2r7epre020Wzs0iHYc1hWlZWOrCw5pc3Yt0UUVzHeFFFFABRRRQAVQ1XT49Qs3icckcVfooBO2qODgkkjdrW4/18fGT/GPWrGa19c0b7WgngOydOVYCuehuC7GKVfLmT7yH+Y9q5px5T2cNXVVWe5azRmmZozUHTYfmjNMzRmgLD80ZpmaM0BYfmjNMzRmgLD80ZpmaM0BYfmjNMzRmgLD80ZpmaM0BYfmq8vmXUy2VvnzH++w/gX/GmyzOZBBbrvnboOy+5rptE0dbCHfId8z8sx6k1pCHMcuJrqkrLcu6dZR2NokKAAKMVbooroPHCiiigAooooAKKKKACiiigApvlpv3bRn1p1FABRRRQAUUUUAFZ+rWC3tsQOHHKkdQa0KKBNX0ZytpcM4aGb5Z4+GHr7irNT6vpZkIubb5Zk5Hv7VnW10J8o42TL95D/T2rtp1FNeZ5dei6buti1RTc0ZrSxz3HUU3NGaLBcdRTc0ZosFx1FNzRmiwXHUU3NGaLBcdRTc0ZosFx1FNzRmiwXHUyWZIY2kc4UU2WVIYy8jBVHc0yxs5dVuFmmUpbocoh7+5qZyUFdmtKnKpKyLGjWT3E5vrhcE8Ip/hFdDTURY0CqMAU6uGTcndnrQgoR5UFFFFIoKKKKACiiigAooooAOtYWs6Cl6PNhJjmXlWXrW7RQ1cak4u6PPDNLay+Rep5b9BJ/C3+FWM1119plvfxFJUBz7Vyd3oN9ppLWjebEP+Wb9PwPasJUn0PUoY6L0qaeY3NGapLforbJ0eB/Rxx+fSrIcMMqQR6isXoehFqSuiTNGaZmjNA7D80ZpmaM0BYfmjNMzRmgLD80ZqNnVBlmAHqTVY3wkbZbRvO/T5en50LXYUmoq8nYulgBknAqukk19L5NipPYykfKPp6mrll4dvNQIkvn2x9fKXgf8A1662z0+CyjCRIBgelbRpdZHnV8clpT+8oaPocWnpvb55W5Zm5JNbNFFbnmNtu7CiiigQUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFAB1rF1XRRcnz4D5cy8hhW1RTTa1Qmk1ZnGpeNDJ5F6nlydA/wDC3+FXcg9K2b3ToL2MrIgye9c7caVfaaS1s3mxf882/p6V0wrraR51bBta0/uLNFUI9Ti3bJ1aB/R+n51bV1cZUgj1BroTT1RwtOLsySim5ozTFcdRTc0ZoC46im5ozQFx1FNzVaa/t4OC+5v7q8mga10RbqtcXsVuQvLyHoi9TUMSahqTbYYzbxf3jyx/wrc07QYLP53+eQ9WPNYTrxW2p10sJOWstEZ9jpM99Ktxe8IOVjHQV0scaxIFQYApwAAwBxS1ySk5O7PShCMFaIUUUUiwooooAKKKKACiiigAooooAKKKKACkIBGCM0tFAGfd6PaXikSRLz7VgXPg4IS1nM8R9FOP0rr6KTSe5cJyg7xdjz+XSNZtujJMP9tMH8x/hVdjqUX+s0/P+5Jn+YFejkA9RTTFG3VR+VQ6UTpjjqy63PN/tVyOun3H4Ff8aPtNyfu6fcfiV/xr0Y20J6xr+VAtoR0jX8qXsYl/2jV7L+vmeeKNTl/1dgB7vJ/QCrMWi6zc/ekSEHsif1Oa7wRIvRR+VPwB2pqlFESx1Z9bHJW3g5CQ93K0rf7RzW/a6Va2igRxjj2q9RVpJbHLKcpu8ncQAAYApaKKZIUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABSEAjBFLRQBSutKtboEPGMn2rFn8LGNi1pO8Z9Aa6eimpNbEyhGStJXOMex1m27pMo/vL/hURur6P/W2BPur/wD1q7jANMMaN1UflWqrzRzywdJ9LHE/2m4+9ZXH4Y/xo/tQnpZXH5D/ABrtDbQnrGv5UgtYR/yzX8qr6zMj6hT7v+vkcb9uuX4isJD/ALzY/oaesesXHCQRxD1IJNdkIY16IPypwUDoBUvETZSwVJb6nKReHby55urpyP7o4H6VrWfh+ztMEIGb1Na1FZylKW7OiFOEPhVhqRrGMKoAp1FFSWFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQB//Z
tags:
- mvc
- php
- laravel
---

### mvc 自己封装一个框架

MVC模式（Model-View-Controller）是软件工程中的一种软件架构模式。

MVC把软件系统分为三个基本部分：模型（Model）、视图（View）和控制器（Controller）。

PHP中MVC模式也称Web MVC，从上世纪70年代进化而来。

MVC的目的是实现一种动态的程序设计，便于后续对程序的修改和扩展简化，并且使程序某一部分的重复利用成为可能。

除此之外，此模式通过对复杂度的简化，使程序结构更加直观。

MVC各部分的职能：

### 模型Model – 管理大部分的业务逻辑和所有的数据库逻辑。模型提供了连接和操作数据库的抽象层。

### 控制器Controller – 负责响应用户请求、准备数据，以及决定如何展示数据。

### 视图View – 负责渲染数据，通过HTML方式呈现给用户。

## 一个典型的Web MVC流程：

Controller截获用户发出的请求；

Controller调用Model完成状态的读写操作；

Controller把数据传递给View；

View渲染最终结果并呈献给用户。

在开始开发前，让我们先来把项目建立好。

假设我们建立的项目为 mvc，MVC的框架命名为 mvc，那么接下来，第一步要把目录结构设置好。

├─application           应用目录

│  ├─controllers        控制器目录

│  ├─models             模块目录

│  ├─views              视图目录

├─config                配置文件目录

├─vendor               框架核心目录

├─static                静态文件目录

├─index.php             入口文件

### 代码规范

在目录设置好以后，我们接下来规定代码的规范：

    MySQL的表名需小写或小写加下划线，如：item，car_orders。
    模块名（Models）需用大驼峰命名法，即首字母大写，并在名称后添加Model，如：ItemModel，CarModel。
    控制器（Controllers）需用大驼峰命名法，即首字母大写，并在名称后添加Controller，如：ItemController，CarController。
    方法名（Action）需用小驼峰命名法，即首字母小写，如：index，indexPost。
    视图（Views）部署结构为控制器名/行为名，如：item/view.php，car/buy.php。

上述规则是为了程序能更好地相互调用。

重定向

重定向的目的有两个：设置根目录为project所在位置，以及将所有请求都发送给 index.php 文件。

如果是Apache服务器，在 project 目录下新建一个 .htaccess 文件，内容为：

<IfModule mod_rewrite.c>

    # 打开Rerite功能

    RewriteEngine On

    # 如果请求的是真实存在的文件或目录，直接访问

    RewriteCond %{REQUEST_FILENAME} !-f

    RewriteCond %{REQUEST_FILENAME} !-d

    # 如果访问的文件或目录不是真事存在，分发请求至 index.php

    RewriteRule . index.php

</IfModule>

如果是Nginx服务器，修改配置文件，在server块中加入如下的重定向：

location / {

    # 重新向所有非真是存在的请求到index.php

    try_files $uri $uri/ /index.php$args;

}

这样做的主要原因是：

（1）静态文件能直接访问。

如果文件或者目录真实存在，则直接访问存在的文件/目录。

比如，静态文件static/css/main.css真实存在，就可以直接访问它。

（2）程序有单一的入口。

这种情况是请求地址不是真实存在的文件或目录，这样请求就会传到 index.php 上。

例如，访问地址：localhost/item/view/1，在文件系统中并不存在这样的文件或目录。

那么，Apache或Nginx服务器会把请求发给index.php，并且把域名之后的字符串赋值给REQUEST_URI变量。

这样在PHP中用$_SERVER[‘REQUEST_URI’]就能拿到/item/view/1；

（3）可以用来生成美化的URL，利于SEO。

3.4 入口文件

接下来，在 project 目录下新建 index.php 入口文件，文件内容为：

<?php

// 应用目录为当前目录

define(‘APP_PATH’, __DIR__ . ‘/’);

// 开启调试模式

define(‘APP_DEBUG’, true);

// 加载框架文件

require(APP_PATH . ‘fastphp/Fastphp.php’);

// 加载配置文件

$config = require(APP_PATH . ‘config/config.php’);

// 实例化框架类

(new Fastphp($config))->run();

注意，上面的PHP代码中，并没有添加PHP结束符号?>。

这么做的主要原因是：

对于只有 PHP 代码的文件，最好没有结束标志?>，

PHP自身并不需要结束符号，不加结束符让程序更加安全，很大程度防止了末尾被注入额外的内容。

3.5 配置文件

在入口文件中，我们加载了config.php文件的内容，那它有何作用呢？

从名称不难看出，它的作用是保存一些常用配置。

config.php 文件内容如下，作用是定义数据库连接参数参数，以及配置默认控制器名和操作名：

<?php

// 数据库配置

define(‘DB_NAME’, ‘project’);

define(‘DB_USER’, ‘root’);

define(‘DB_PASSWORD’, ‘123456’);

define(‘DB_HOST’, ‘localhost’);

// 默认控制器和操作名

$config[‘defaultController’] = ‘Item’;

$config[‘defaultAction’] = ‘index’;

return $config;

入口中的$config变量接收到配置参数后，再传给框架的核心类，也就是Fastphp类。

 

3.6 框架核心类

入口文件对框架类做了两步操作：实例化，调用run()方法。

实例化操作接受$config参数配置，并保存到类属性中。

run()方法则调用用类自身方法，完成：自动加载类文件、监测开发环境、过滤敏感字符、移除全局变量的老用法、和处理路由。

<?php

/**

* fastphp框架核心

*/

class Fastphp

{

    protected $_config = [];

    public function __construct($config)

    {

        $this->_config = $config;

    }

    // 运行程序

    public function run()

    {

        spl_autoload_register(array($this, ‘loadClass’));

        $this->setReporting();

        $this->removeMagicQuotes();

        $this->unregisterGlobals();

        $this->setDbConfig();

        $this->route();

    }

    // 路由处理

    public function route()

    {

        $controllerName = $this->_config[‘defaultController’];

        $actionName = $this->_config[‘defaultAction’];

        $param = array();

        $url = $_SERVER[‘REQUEST_URI’];

        // 清除?之后的内容

        $position = strpos($url, ‘?’);

        $url = $position === false ? $url : substr($url, 0, $position);

        // 删除前后的“/”

        $url = trim($url, ‘/’);

        if ($url) {

            // 使用“/”分割字符串，并保存在数组中

            $urlArray = explode(‘/’, $url);

            // 删除空的数组元素

            $urlArray = array_filter($urlArray);

            

            // 获取控制器名

            $controllerName = ucfirst($urlArray[0]);

            

            // 获取动作名

            array_shift($urlArray);

            $actionName = $urlArray ? $urlArray[0] : $actionName;

            

            // 获取URL参数

            array_shift($urlArray);

            $param = $urlArray ? $urlArray : array();

        }

        // 判断控制器和操作是否存在

        $controller = $controllerName . ‘Controller’;

        if (!class_exists($controller)) {

            exit($controller . ‘控制器不存在‘);

        }

        if (!method_exists($controller, $actionName)) {

            exit($actionName . ‘方法不存在‘);

        }

        // 如果控制器和操作名存在，则实例化控制器，因为控制器对象里面

        // 还会用到控制器名和操作名，所以实例化的时候把他们俩的名称也

        // 传进去。结合Controller基类一起看

        $dispatch = new $controller($controllerName, $actionName);

        // $dispatch保存控制器实例化后的对象，我们就可以调用它的方法，

        // 也可以像方法中传入参数，以下等同于：$dispatch->$actionName($param)

        call_user_func_array(array($dispatch, $actionName), $param);

    }

    // 检测开发环境

    public function setReporting()

    {

        if (APP_DEBUG === true) {

            error_reporting(E_ALL);

            ini_set(‘display_errors’,’On’);

        } else {

            error_reporting(E_ALL);

            ini_set(‘display_errors’,’Off’);

            ini_set(‘log_errors’, ‘On’);

        }

    }

    // 删除敏感字符

    public function stripSlashesDeep($value)

    {

        $value = is_array($value) ? array_map(array($this, ‘stripSlashesDeep’), $value) : stripslashes($value);

        return $value;

    }

    // 检测敏感字符并删除

    public function removeMagicQuotes()

    {

        if (get_magic_quotes_gpc()) {

            $_GET = isset($_GET) ? $this->stripSlashesDeep($_GET ) : ”;

            $_POST = isset($_POST) ? $this->stripSlashesDeep($_POST ) : ”;

            $_COOKIE = isset($_COOKIE) ? $this->stripSlashesDeep($_COOKIE) : ”;

            $_SESSION = isset($_SESSION) ? $this->stripSlashesDeep($_SESSION) : ”;

        }

    }

    // 检测自定义全局变量并移除。因为 register_globals 已经弃用，如果

    // 已经弃用的 register_globals 指令被设置为 on，那么局部变量也将

    // 在脚本的全局作用域中可用。 例如， $_POST[‘foo’] 也将以 $foo 的

    // 形式存在，这样写是不好的实现，会影响代码中的其他变量。 相关信息，

    // 参考: http://php.net/manual/zh/faq.using.php#faq.register-globals

    public function unregisterGlobals()

    {

        if (ini_get(‘register_globals’)) {

            $array = array(‘_SESSION’, ‘_POST’, ‘_GET’, ‘_COOKIE’, ‘_REQUEST’, ‘_SERVER’, ‘_ENV’, ‘_FILES’);

            foreach ($array as $value) {

                foreach ($GLOBALS[$value] as $key => $var) {

                    if ($var === $GLOBALS[$key]) {

                        unset($GLOBALS[$key]);

                    }

                }

            }

        }

    }

    // 配置数据库信息

    public function setDbConfig()

    {

        if ($this->_config[‘db’]) {

            Model::$dbConfig = $this->_config[‘db’];

        }

    }

    // 自动加载控制器和模型类

    public static function loadClass($class)

    {

        $frameworks = __DIR__ . ‘/’ . $class . ‘.php’;

        $controllers = APP_PATH . ‘application/controllers/’ . $class . ‘.php’;

        $models = APP_PATH . ‘application/models/’ . $class . ‘.php’;

        if (file_exists($frameworks)) {

            // 加载框架核心类

            include $frameworks;

        } elseif (file_exists($controllers)) {

            // 加载应用控制器类

            include $controllers;

        } elseif (file_exists($models)) {

            //加载应用模型类

            include $models;4

        } else {

            // 错误代码

        }

    }

}

下面重点讲解主请求方法 route()，它也称路由方法，作用是：截取URL，并解析出控制器名、方法名和URL参数。

假设我们的 URL 是这样：

yoursite.com/controllerName/actionName/queryString

当浏览器访问上面的URL，route()从全局变量 $_SERVER[‘REQUEST_URI’]中获取到字符串/controllerName/actionName/queryString。

然后，会将这个字符串分割成三部分：controller、action 和 queryString。

例如，URL链接为：yoursite.com/item/view/1/hello，那么route()分割之后，

    Controller名就是：item
    action名就是：view
    URL参数就是：array(1, hello)

分割完成后，再实例化控制器：itemController，并调用其中的view方法 。

3.7 Controller基类

接下来，就是在 fastphp 中创建MVC基类，包括控制器、模型和视图三个基类。

新建控制器基类，文件名 Controller.class.php，功能就是总调度，内容如下：

<?php

/**

* 控制器基类

*/

class Controller

{

    protected $_controller;

    protected $_action;

    protected $_view;

    // 构造函数，初始化属性，并实例化对应模型

    public function __construct($controller, $action)

    {

        $this->_controller = $controller;

        $this->_action = $action;

        $this->_view = new View($controller, $action);

    }

    // 分配变量

    public function assign($name, $value)

    {

        $this->_view->assign($name, $value);

    }

    // 渲染视图

    public function render()

    {

        $this->_view->render();

    }

}

Controller 类用assign()方法实现把变量保存到View对象中。

这样，在调用$this-> render() 后视图文件就能显示这些变量。

3.8 Model基类

新建模型基类，继承自数据库操作类Sql类（因为数据库操作比较复杂）。

模型基类文件名为 Model.class.php，代码如下：

<?php

class Model extends Sql

{

    protected $_model;

    protected $_table;

    public static $dbConfig = [];

    public function __construct()

    {

        // 连接数据库

        $this->connect(self::$dbConfig[‘host’], self::$dbConfig[‘username’], self::$dbConfig[‘password’],

            self::$dbConfig[‘dbname’]);

        // 获取数据库表名

        if (!$this->_table) {

            // 获取模型类名称

            $this->_model = get_class($this);

            // 删除类名最后的 Model 字符

            $this->_model = substr($this->_model, 0, -5);

            // 数据库表名与类名一致

            $this->_table = strtolower($this->_model);

        }

    }

}

建立一个数据库基类 Sql.class.php，代码如下：

<?php

class Sql

{

    protected $_dbHandle;

    protected $_result;

    private $filter = ”;

    // 连接数据库

    public function connect($host, $username, $password, $dbname)

    {

        try {

            $dsn = sprintf(“mysql:host=%s;dbname=%s;charset=utf8”, $host, $dbname);

            $option = array(PDO::ATTR_DEFAULT_FETCH_MODE => PDO::FETCH_ASSOC);

            $this->_dbHandle = new PDO($dsn, $username, $password, $option);

        } catch (PDOException $e) {

            exit(‘错误: ‘ . $e->getMessage());

        }

    }

    // 查询条件

    public function where($where = array())

    {

        if (isset($where)) {

            $this->filter .= ‘ WHERE ‘;

            $this->filter .= implode(‘ ‘, $where);

        }

        return $this;

    }

    // 排序条件

    public function order($order = array())

    {

        if(isset($order)) {

            $this->filter .= ‘ ORDER BY ‘;

            $this->filter .= implode(‘,’, $order);

        }

        return $this;

    }

    // 查询所有

    public function selectAll()

    {

        $sql = sprintf(“select * from `%s` %s”, $this->_table, $this->filter);

        $sth = $this->_dbHandle->prepare($sql);

        $sth->execute();

        return $sth->fetchAll();

    }

    // 根据条件 (id) 查询

    public function select($id)

    {

        $sql = sprintf(“select * from `%s` where `id` = ‘%s'”, $this->_table, $id);

        $sth = $this->_dbHandle->prepare($sql);

        $sth->execute();

        return $sth->fetch();

    }

    // 根据条件 (id) 删除

    public function delete($id)

    {

        $sql = sprintf(“delete from `%s` where `id` = ‘%s'”, $this->_table, $id);

        $sth = $this->_dbHandle->prepare($sql);

        $sth->execute();

        return $sth->rowCount();

    }

    // 自定义SQL查询，返回影响的行数

    public function query($sql)

    {

        $sth = $this->_dbHandle->prepare($sql);

        $sth->execute();

        return $sth->rowCount();

    }

    // 新增数据

    public function add($data)

    {

        $sql = sprintf(“insert into `%s` %s”, $this->_table, $this->formatInsert($data));

        return $this->query($sql);

    }

    // 修改数据

    public function update($id, $data)

    {

        $sql = sprintf(“update `%s` set %s where `id` = ‘%s'”, $this->_table, $this->formatUpdate($data), $id);

        return $this->query($sql);

    }

    // 将数组转换成插入格式的sql语句

    private function formatInsert($data)

    {

        $fields = array();

        $values = array();

        foreach ($data as $key => $value) {

            $fields[] = sprintf(“`%s`”, $key);

            $values[] = sprintf(“‘%s'”, $value);

        }

        $field = implode(‘,’, $fields);

        $value = implode(‘,’, $values);

        return sprintf(“(%s) values (%s)”, $field, $value);

    }

    // 将数组转换成更新格式的sql语句

    private function formatUpdate($data)

    {

        $fields = array();

        foreach ($data as $key => $value) {

            $fields[] = sprintf(“`%s` = ‘%s'”, $key, $value);

        }

        return implode(‘,’, $fields);

    }

}

应该说，Sql.class.php 是框架的核心部分。为什么？

因为通过它，我们创建了一个 SQL 抽象层，可以大大减少了数据库的编程工作。

虽然 PDO 接口本来已经很简洁，但是抽象之后框架的可灵活性更高。

这里的数据库句柄$this->_dbHandle还能用单例模式返回，让数据读写更高效，这部分可自行实现。

3.9 View基类

视图基类 View.class.php 内容如下：

<?php

/**

* 视图基类

*/

class View

{

    protected $variables = array();

    protected $_controller;

    protected $_action;

    function __construct($controller, $action)

    {

        $this->_controller = strtolower($controller);

        $this->_action = strtolower($action);

    }

    // 分配变量

    public function assign($name, $value)

    {

        $this->variables[$name] = $value;

    }

    // 渲染显示

    public function render()

    {

        extract($this->variables);

        $defaultHeader = APP_PATH . ‘application/views/header.php’;

        $defaultFooter = APP_PATH . ‘application/views/footer.php’;

        $controllerHeader = APP_PATH . ‘application/views/’ . $this->_controller . ‘/header.php’;

        $controllerFooter = APP_PATH . ‘application/views/’ . $this->_controller . ‘/footer.php’;

        $controllerLayout = APP_PATH . ‘application/views/’ . $this->_controller . ‘/’ . $this->_action . ‘.php’;

        // 页头文件

        if (file_exists($controllerHeader)) {

            include ($controllerHeader);

        } else {

            include ($defaultHeader);

        }

        include ($controllerLayout);

        

        // 页脚文件

        if (file_exists($controllerFooter)) {

            include ($controllerFooter);

        } else {

            include ($defaultFooter);

        }

    }

}

这样，核心的PHP MVC框架核心就完成了。

下面我们编写应用来测试框架功能。

4 应用

4.1 数据库部署

在 SQL 中新建一个 project 数据库，增加一个item 表、并插入两条记录，命令如下：

CREATE DATABASE `project` DEFAULT CHARACTER SET utf8 COLLATE utf8_general_ci;

USE `project`;

CREATE TABLE `item` (

    `id` int(11) NOT NULL auto_increment,

    `item_name` varchar(255) NOT NULL,

    PRIMARY KEY (`id`)

) ENGINE=InnoDB AUTO_INCREMENT=1 DEFAULT CHARSET=utf8;

INSERT INTO `item` VALUES(1, ‘Hello World.’);

INSERT INTO `item` VALUES(2, ‘Lets go!’);

4.2 部署模型

然后，我们还需要在 models 目录中创建一个 ItemModel.php 模型，内容如下：

<?php

/**

* 用户Model

*/

class ItemModel extends Model

{

    /**

     * 自定义当前模型操作的数据库表名称，

     * 如果不指定默认为类名称的小写字符串，

     * 这里就是 item 表

     * @var string

     */

    public $_table = ‘item’;

    /**

     * 搜索功能，因为Sql父类里面没有现成的like搜索，

     * 所以需要自己写SQL语句，对数据库的操作应该都放

     * 在Model里面，然后提供给Controller直接调用

     * @param $title string 查询的关键词

     * @return array 返回的数据

     */

    public function search($keyword)

    {

        $sql = “select * from `$this->_table` where `item_name` like ‘%$keyword%'”;

        $sth = $this->_dbHandle->prepare($sql);

        $sth->execute();

        return $sth->fetchAll();

    }

}

因为 Item 模型继承了 Model基类，所以它拥有 Model 类的所有功能。

4.3 部署控制器

在 controllers 目录下创建一个 ItemController.php 控制器，内容如下：

<?php

class ItemController extends Controller

{

    // 首页方法，测试框架自定义DB查询

    public function index()

    {

        $keyword = isset($_GET[‘keyword’]) ? $_GET[‘keyword’] : ”;

        if ($keyword) {

            $items = (new ItemModel())->search($keyword);

        } else {

            $items = (new ItemModel)->selectAll();

        }

        $this->assign(‘title’, ‘全部条目‘);

        $this->assign(‘keyword’, $keyword);

        $this->assign(‘items’, $items);

        $this->render();

    }

    

    // 添加记录，测试框架DB记录创建（Create）

    public function add()

    {

        $data[‘item_name’] = $_POST[‘value’];

        $count = (new ItemModel)->add($data);

        $this->assign(‘title’, ‘添加成功‘);

        $this->assign(‘count’, $count);

        $this->render();

    }

    

    // 操作管理

    public function manage($id = 0)

    {

        $item = array();

        $postUrl = ‘/item/add’;

        if ($id) {

            $item = (new ItemModel)->select($id);

            $postUrl = ‘/item/update’;

        }

        $this->assign(‘title’, ‘管理条目‘);

        $this->assign(‘item’, $item);

        $this->assign(‘postUrl’, $postUrl);

        $this->render();

    }

    

    // 更新记录，测试框架DB记录更新（Update）

    public function update()

    {

        $data = array(‘id’ => $_POST[‘id’], ‘item_name’ => $_POST[‘value’]);

        $count = (new ItemModel)->update($data[‘id’], $data);

        $this->assign(‘title’, ‘修改成功‘);

        $this->assign(‘count’, $count);

        $this->render();

    }

    

    // 删除记录，测试框架DB记录删除（Delete）

    public function delete($id = null)

    {

        $count = (new ItemModel)->delete($id);

        $this->assign(‘title’, ‘删除成功‘);

        $this->assign(‘count’, $count);

        $this->render();

    }

}

4.4 部署视图

在 views 目录下新建 header.php 和 footer.php 两个页头页脚模板，如下。

header.php 内容：

<html>

<head>

    <meta http-equiv=”Content-Type” content=”text/html; charset=utf-8″ />

    <title><?php echo $title ?></title>

    <link rel=”stylesheet” href=”/static/css/main.css” type=”text/css” />

</head>

<body>

    <h1><?php echo $title ?></h1>

footer.php 内容：

</body>

</html>

页头文件用到了main.css样式文件，内容：

html, body {

    margin: 0;

    padding: 10px;

    font-size: 20px;

}

input {

    font-family:georgia,times;

    font-size:24px;

    line-height:1.2em;

}

a {

    color:blue;

    font-family:georgia,times;

    line-height:1.2em;

    text-decoration:none;

}

a:hover {

    text-decoration:underline;

}

h1 {

    color:#000000;

    font-size:41px;

    border-bottom:1px dotted #cccccc;

}

td {padding: 1px 30px 1px 0;}

然后，在 views/item 创建以下几个视图文件。

index.php，浏览数据库内 item 表的所有记录，内容：

<form action=”” method=”get”>

    <input type=”text” value=”<?php echo $keyword ?>” name=”keyword”>

    <input type=”submit” value=”搜索“>

</form>

<p><a href=”/item/manage”>新建</a></p>

<table>

    <tr>

        <th>ID</th>

        <th>内容</th>

        <th>操作</th>

    </tr>

    <?php foreach ($items as $item): ?>

        <tr>

            <td><?php echo $item[‘id’] ?></td>

            <td><?php echo $item[‘item_name’] ?></td>

            <td>

                <a href=”/item/manage/<?php echo $item[‘id’] ?>”>编辑</a>

                <a href=”/item/delete/<?php echo $item[‘id’] ?>”>删除</a>

            </td>

        </tr>

    <?php endforeach ?>

</table>

add.php，添加记录后的提示，内容：

<a class=”big” href=”/item/index”>成功添加<?php echo $count ?>条记录，点击返回</a>

manage.php，管理记录，内容：

<form action=”<?php echo $postUrl; ?>” method=”post”>

    <?php if (isset($item[‘id’])): ?>

        <input type=”hidden” name=”id” value=”<?php echo $item[‘id’] ?>”>

    <?php endif; ?>

    <input type=”text” name=”value” value=”<?php echo isset($item[‘item_name’]) ? $item[‘item_name’] : ” ?>”>

    <input type=”submit” value=”提交“>

</form>

<a class=”big” href=”/item/index”>返回</a>

update.php，更改记录后的提示，内容：

<a class=”big” href=”/item/index”>成功修改<?php echo $count ?>项，点击返回</a>

delete.php，删除记录后的提示，内容：

<a href=”/item/index”>成功删除<?php echo $count ?>项，点击返回</a>

4.5 应用测试

这样，在浏览器中访问 project程序：http://localhost/item/index/，就可以看到效果了。
